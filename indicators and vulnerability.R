library("tidyverse")

#cases by region
json_file1 <- "https://bioportal.salud.pr.gov/api/administration/reports/cases/dashboard-region"
url1 <- jsonlite::fromJSON(json_file1)

#cases by age-group and sex
json_file2 <- "https://bioportal.salud.pr.gov/api/administration/reports/cases/dashboard-age-group"
url2 <- jsonlite::fromJSON(json_file2)

#code that does not work:
#json_file3 <- "https://bioportal.salud.pr.gov/api/administration/reports/minimal-info-unique-tests"
#url3 <- jsonlite::fromJSON(json_file3)

#json_file4 <- "https://bioportal.salud.pr.gov/api/administration/reports/orders/basic"
#url4 <- jsonlite::fromJSON(json_file4)
#PR cases by city & ageRange

casospr_raw <- read_csv("municipios-edad-2022-02-13.csv")

casospr <- casospr_raw %>% filter(positives > 0, testType == "Molecular") %>% group_by(patientCity, ageRange) %>% 
  summarize(positives = sum(positives), .groups = "drop") %>%
  ungroup()

#vulnerability
vuln <- read_csv("SVI de tormos et al.csv")




